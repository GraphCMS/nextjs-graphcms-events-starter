{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _objectWithoutProperties from \"@babel/runtime-corejs2/helpers/esm/objectWithoutProperties\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nvar _jsxFileName = \"/Users/jmartin/Development/GraphCMS/Microsites/graphcms-events/src/pages/[event-slug].js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport Image from 'graphcms-image';\nimport Speakers from '../components/Speakers';\nimport Venue from '../components/Venue';\nimport Schedule from '../components/Schedule';\nimport Sponsors from '../components/Sponsors';\n\nvar _require = require('graphql-request'),\n    GraphQLClient = _require.GraphQLClient;\n\nfunction EventPage(_ref) {\n  var event = _ref.event,\n      speakers = _ref.speakers,\n      venue = _ref.venue,\n      sponsors = _ref.sponsors,\n      tracks = _ref.tracks;\n  return __jsx(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 13\n    },\n    __self: this\n  }, __jsx(\"section\", {\n    className: \"bg-cover bg-purple-800 pb-32 pt-8\",\n    style: {\n      clipPath: 'polygon(0% 0%, 100% 0%, 100% 66%, 0% 100%)'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 14\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"container mx-auto px-6 py-12 lg:py-20\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 20\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"w-2/3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 21\n    },\n    __self: this\n  }, __jsx(\"h1\", {\n    className: \"text-white text-4xl md:text-6xl font-bold mb-4 leading-tight\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 22\n    },\n    __self: this\n  }, event.title), __jsx(\"div\", {\n    className: \"body-copy\",\n    dangerouslySetInnerHTML: {\n      __html: event.description.html\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 25\n    },\n    __self: this\n  })))), __jsx(Speakers, {\n    speakers: speakers,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32\n    },\n    __self: this\n  }), __jsx(Schedule, {\n    tracks: tracks,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33\n    },\n    __self: this\n  }), __jsx(Venue, _extends({}, venue, {\n    image: event.image,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34\n    },\n    __self: this\n  })), __jsx(Sponsors, {\n    sponsors: sponsors,\n    event: event.title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35\n    },\n    __self: this\n  }));\n}\n\nEventPage.getInitialProps = function _callee(ctx) {\n  var query, graphQLClient, request, event, tracks, sponsors, venue, rest, sortByStart, speakers;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          query = \"\\n    fragment assetInfo on Asset {\\n      handle\\n      width\\n      height\\n      url\\n    }\\n  \\n    fragment venueInfo on Venue {\\n      id\\n      name\\n      location {\\n        lat: latitude\\n        lng: longitude\\n      }\\n      street\\n      city\\n      postcode\\n      country\\n    }\\n  \\n    fragment speakerInfo on Speaker {\\n      name\\n      headline\\n      photo {\\n        ...assetInfo\\n      }\\n    }\\n  \\n    fragment talkInfo on Talk {\\n      id\\n      title\\n      speaker {\\n        ...speakerInfo\\n      }\\n    }\\n  \\n    fragment trackInfo on Track {\\n      id\\n      title\\n      mc {\\n        ...speakerInfo\\n      }\\n      timeSlots(orderBy: start_ASC) {\\n        id\\n        start\\n        end\\n        talk {\\n          ...talkInfo\\n        }\\n        sessionBreak: break {\\n          title\\n        }\\n      }\\n    }\\n  \\n    fragment EventInfo on Event {\\n      id\\n      title\\n      slug\\n      start\\n      image {\\n        ...assetInfo\\n      }\\n      description {\\n        html\\n      }\\n      tracks {\\n        ...trackInfo\\n      }\\n      sponsors {\\n        name\\n        url\\n        logo {\\n          ...assetInfo\\n        }\\n      }\\n      venue {\\n        ...venueInfo\\n      }\\n    }\\n  \\n    query {\\n        event(where:{\\n            slug: \\\"content-creators-remote-2020\\\"\\n          }) {\\n            ...EventInfo\\n          }\\n    }\\n  \";\n          graphQLClient = new GraphQLClient(process.env.GRAPHCMS_ENDPOINT, {\n            credentials: 'include',\n            mode: 'cors',\n            headers: {\n              Authorization: \"Bearer \".concat(process.env.GATSBY_GRAPHCMS_TOKEN)\n            }\n          });\n          _context.next = 4;\n          return _regeneratorRuntime.awrap(graphQLClient.request(query));\n\n        case 4:\n          request = _context.sent;\n          event = request.event;\n\n          if (!event) {\n            _context.next = 11;\n            break;\n          }\n\n          tracks = event.tracks, sponsors = event.sponsors, venue = event.venue, rest = _objectWithoutProperties(event, [\"tracks\", \"sponsors\", \"venue\"]);\n\n          sortByStart = function sortByStart(a, b) {\n            if (a.start < b.start) return -1;\n            if (a.start > b.start) return 1;\n            if (a.start === b.start) return 0;\n          };\n\n          speakers = tracks.reduce(function (collector, currentTrack) {\n            return [].concat(_toConsumableArray(collector), _toConsumableArray(currentTrack.timeSlots.map(function (timeSlot) {\n              return timeSlot.talk ? timeSlot.talk.speaker : null;\n            }))).filter(Boolean).sort(sortBySpeaker).reduce(function (collector, current) {\n              if (collector.length) {\n                if (current.name === collector[collector.length - 1].name) {\n                  return collector;\n                } else {\n                  return [].concat(_toConsumableArray(collector), [current]);\n                }\n              } else {\n                return [].concat(_toConsumableArray(collector), [current]);\n              }\n            }, []);\n          }, []);\n          return _context.abrupt(\"return\", {\n            sponsors: sponsors,\n            venue: venue,\n            speakers: speakers,\n            tracks: tracks,\n            event: rest\n          });\n\n        case 11:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n};\n\nexport default EventPage;","map":{"version":3,"sources":["/Users/jmartin/Development/GraphCMS/Microsites/graphcms-events/src/pages/[event-slug].js"],"names":["React","Image","Speakers","Venue","Schedule","Sponsors","require","GraphQLClient","EventPage","event","speakers","venue","sponsors","tracks","clipPath","title","__html","description","html","image","getInitialProps","ctx","query","graphQLClient","process","env","GRAPHCMS_ENDPOINT","credentials","mode","headers","Authorization","GATSBY_GRAPHCMS_TOKEN","request","rest","sortByStart","a","b","start","reduce","collector","currentTrack","timeSlots","map","timeSlot","talk","speaker","filter","Boolean","sort","sortBySpeaker","current","length","name"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Image from 'graphcms-image';\n\nimport Speakers from '../components/Speakers';\nimport Venue from '../components/Venue';\nimport Schedule from '../components/Schedule';\nimport Sponsors from '../components/Sponsors';\n\nconst { GraphQLClient } = require('graphql-request');\n\nfunction EventPage({ event, speakers, venue, sponsors, tracks }) {\n  return (\n    <React.Fragment>\n      <section\n        className=\"bg-cover bg-purple-800 pb-32 pt-8\"\n        style={{\n          clipPath: 'polygon(0% 0%, 100% 0%, 100% 66%, 0% 100%)',\n        }}\n      >\n        <div className=\"container mx-auto px-6 py-12 lg:py-20\">\n          <div className=\"w-2/3\">\n            <h1 className=\"text-white text-4xl md:text-6xl font-bold mb-4 leading-tight\">\n              {event.title}\n            </h1>\n            <div\n              className=\"body-copy\"\n              dangerouslySetInnerHTML={{ __html: event.description.html }}\n            />\n          </div>\n        </div>\n      </section>\n      <Speakers speakers={speakers} />\n      <Schedule tracks={tracks} />\n      <Venue {...venue} image={event.image} />\n      <Sponsors sponsors={sponsors} event={event.title} />\n    </React.Fragment>\n  );\n}\n\nEventPage.getInitialProps = async ctx => {\n  const query = `\n    fragment assetInfo on Asset {\n      handle\n      width\n      height\n      url\n    }\n  \n    fragment venueInfo on Venue {\n      id\n      name\n      location {\n        lat: latitude\n        lng: longitude\n      }\n      street\n      city\n      postcode\n      country\n    }\n  \n    fragment speakerInfo on Speaker {\n      name\n      headline\n      photo {\n        ...assetInfo\n      }\n    }\n  \n    fragment talkInfo on Talk {\n      id\n      title\n      speaker {\n        ...speakerInfo\n      }\n    }\n  \n    fragment trackInfo on Track {\n      id\n      title\n      mc {\n        ...speakerInfo\n      }\n      timeSlots(orderBy: start_ASC) {\n        id\n        start\n        end\n        talk {\n          ...talkInfo\n        }\n        sessionBreak: break {\n          title\n        }\n      }\n    }\n  \n    fragment EventInfo on Event {\n      id\n      title\n      slug\n      start\n      image {\n        ...assetInfo\n      }\n      description {\n        html\n      }\n      tracks {\n        ...trackInfo\n      }\n      sponsors {\n        name\n        url\n        logo {\n          ...assetInfo\n        }\n      }\n      venue {\n        ...venueInfo\n      }\n    }\n  \n    query {\n        event(where:{\n            slug: \"content-creators-remote-2020\"\n          }) {\n            ...EventInfo\n          }\n    }\n  `;\n\n  const graphQLClient = new GraphQLClient(process.env.GRAPHCMS_ENDPOINT, {\n    credentials: 'include',\n    mode: 'cors',\n    headers: {\n      Authorization: `Bearer ${process.env.GATSBY_GRAPHCMS_TOKEN}`,\n    },\n  });\n\n  const request = await graphQLClient.request(query);\n  const { event } = request;\n\n  if (event) {\n    const { tracks, sponsors, venue, ...rest } = event;\n\n    const sortByStart = (a, b) => {\n      if (a.start < b.start) return -1;\n      if (a.start > b.start) return 1;\n      if (a.start === b.start) return 0;\n    };\n\n    const speakers = tracks.reduce((collector, currentTrack) => {\n      return [\n        ...collector,\n        ...currentTrack.timeSlots.map(timeSlot =>\n          timeSlot.talk ? timeSlot.talk.speaker : null\n        ),\n      ]\n        .filter(Boolean)\n        .sort(sortBySpeaker)\n        .reduce((collector, current) => {\n          if (collector.length) {\n            if (current.name === collector[collector.length - 1].name) {\n              return collector;\n            } else {\n              return [...collector, current];\n            }\n          } else {\n            return [...collector, current];\n          }\n        }, []);\n    }, []);\n\n    return {\n      sponsors,\n      venue,\n      speakers,\n      tracks,\n      event: rest,\n    };\n  }\n};\n\nexport default EventPage;\n"]},"metadata":{},"sourceType":"module"}