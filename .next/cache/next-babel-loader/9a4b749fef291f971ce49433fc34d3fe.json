{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _objectWithoutProperties from \"@babel/runtime-corejs2/helpers/esm/objectWithoutProperties\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nvar _jsxFileName = \"/Users/jmartin/Development/GraphCMS/Microsites/graphcms-events/src/pages/index.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { Link } from 'next/link';\nimport Sponsors from '../components/Sponsors';\n\nvar _require = require('graphql-request'),\n    GraphQLClient = _require.GraphQLClient;\n\nvar Wrapper = function Wrapper(props) {\n  return __jsx(\"section\", _extends({\n    className: \"container mx-auto px-6 py-12 lg:py-20\"\n  }, props, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 8\n    },\n    __self: this\n  }));\n};\n\nvar Home = function Home(_ref) {\n  var futureEvents = _ref.futureEvents,\n      pastEvents = _ref.pastEvents,\n      globalSponsors = _ref.globalSponsors;\n  var next = futureEvents[0];\n  return __jsx(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 14\n    },\n    __self: this\n  }, __jsx(\"section\", {\n    className: \"bg-cover bg-purple-800 pb-32 pt-8\",\n    style: {\n      backgroundImage: \"linear-gradient(rgba(107, 70, 193,0.85), rgba(107, 70, 193,0.5)), url(\".concat(next.image.url, \")\"),\n      clipPath: 'polygon(0% 0%, 100% 0%, 100% 85%, 30% 85%, 30% 100%, 0% 85%)'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 15\n    },\n    __self: this\n  }, __jsx(Wrapper, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 23\n    },\n    __self: this\n  }, __jsx(Link, {\n    href: next.slug,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 24\n    },\n    __self: this\n  }, __jsx(\"a\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 25\n    },\n    __self: this\n  }, __jsx(\"article\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 26\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"z-10 relative px-4 self-center w-2/3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27\n    },\n    __self: this\n  }, __jsx(\"p\", {\n    className: \"text-white inline-block font-bold text-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28\n    },\n    __self: this\n  }, \"Up Next\"), __jsx(\"h1\", {\n    className: \"text-6xl font-bold leading-tight text-white\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31\n    },\n    __self: this\n  }, next.title), __jsx(\"p\", {\n    className: \"text-xl font-bold pb-3 text-purple-200\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34\n    },\n    __self: this\n  }, next.venue && next.venue.name)), __jsx(\"section\", {\n    className: \"flex flex-wrap\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"w-full md:w-1/2 text-white bg-gray-900 p-6\",\n    dangerouslySetInnerHTML: {\n      __html: next.description.html\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39\n    },\n    __self: this\n  }))))))), __jsx(Wrapper, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }, __jsx(\"h2\", {\n    className: \"text-purple-800 text-4xl md:text-6xl font-bold mb-6\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  }, \"Upcoming Events\"), __jsx(\"section\", {\n    className: \"flex flex-wrap overflow-hidden -mx-2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, futureEvents && futureEvents.slice(1).map(function (event, index) {\n    return __jsx(Link, {\n      className: \"w-full md:w-1/2 px-2 mb-10\",\n      href: event.slug,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57\n      },\n      __self: this\n    }, __jsx(\"a\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, __jsx(\"article\", {\n      key: index,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, __jsx(\"img\", {\n      src: event.image ? event.image.url : '',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }), __jsx(\"h1\", {\n      className: \"font-bold text-gray-800 text-xl mb-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, event.title), __jsx(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, event.venue ? event.venue.name : 'TBD'))));\n  }))), __jsx(Sponsors, {\n    sponsors: globalSponsors,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }));\n};\n\nHome.getInitialProps = function _callee(ctx) {\n  var query, graphQLClient, request, events, globalSponsors, pastEvents, futureEvents, now, sortByStart, sortBySpeaker;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          query = \"\\n  fragment assetInfo on Asset {\\n    handle\\n    width\\n    height\\n    url\\n  }\\n\\n  fragment venueInfo on Venue {\\n    id\\n    name\\n    location {\\n      lat: latitude\\n      lng: longitude\\n    }\\n    street\\n    city\\n    postcode\\n    country\\n  }\\n\\n  fragment speakerInfo on Speaker {\\n    name\\n    headline\\n    photo {\\n      ...assetInfo\\n    }\\n  }\\n\\n  fragment talkInfo on Talk {\\n    id\\n    title\\n    speaker {\\n      ...speakerInfo\\n    }\\n  }\\n\\n  fragment trackInfo on Track {\\n    id\\n    title\\n    mc {\\n      ...speakerInfo\\n    }\\n    timeSlots(orderBy: start_ASC) {\\n      id\\n      start\\n      end\\n      talk {\\n        ...talkInfo\\n      }\\n      sessionBreak: break {\\n        title\\n      }\\n    }\\n  }\\n\\n  fragment EventInfo on Event {\\n    id\\n    title\\n    slug\\n    start\\n    image {\\n      ...assetInfo\\n    }\\n    description {\\n      html\\n    }\\n    tracks {\\n      ...trackInfo\\n    }\\n    sponsors {\\n      name\\n      url\\n      logo {\\n        ...assetInfo\\n      }\\n    }\\n    venue {\\n      ...venueInfo\\n    }\\n  }\\n\\n  query {\\n      globalSponsors: sponsors(where: {\\n        type: GLOBAL\\n      }) {\\n        name\\n        url\\n        logo {\\n          ...assetInfo\\n        }\\n      }\\n      events {\\n        ...EventInfo\\n      }\\n  }\\n\";\n          graphQLClient = new GraphQLClient(process.env.GRAPHCMS_ENDPOINT, {\n            credentials: 'include',\n            mode: 'cors',\n            headers: {\n              Authorization: \"Bearer \".concat(process.env.GATSBY_GRAPHCMS_TOKEN)\n            }\n          });\n          _context.next = 4;\n          return _regeneratorRuntime.awrap(graphQLClient.request(query));\n\n        case 4:\n          request = _context.sent;\n          events = request.events, globalSponsors = request.globalSponsors;\n\n          if (!events) {\n            _context.next = 16;\n            break;\n          }\n\n          pastEvents = [];\n          futureEvents = [];\n          now = new Date();\n\n          sortByStart = function sortByStart(a, b) {\n            if (a.start < b.start) return -1;\n            if (a.start > b.start) return 1;\n            if (a.start === b.start) return 0;\n          };\n\n          sortBySpeaker = function sortBySpeaker(a, b) {\n            if (a.name < b.name) return -1;\n            if (a.name > b.name) return 1;\n            if (a.name === b.name) return 0;\n          };\n\n          events.forEach(function (payload) {\n            var tracks = payload.tracks,\n                sponsors = payload.sponsors,\n                venue = payload.venue,\n                event = _objectWithoutProperties(payload, [\"tracks\", \"sponsors\", \"venue\"]);\n\n            if (new Date(event.start) < now) pastEvents.push(payload);\n            if (new Date(event.start) > now) futureEvents.push(payload);\n            var speakers = tracks.reduce(function (collector, currentTrack) {\n              return [].concat(_toConsumableArray(collector), _toConsumableArray(currentTrack.timeSlots.map(function (timeSlot) {\n                return timeSlot.talk ? timeSlot.talk.speaker : null;\n              }))).filter(Boolean).sort(sortBySpeaker).reduce(function (collector, current) {\n                if (collector.length) {\n                  if (current.name === collector[collector.length - 1].name) {\n                    return collector;\n                  } else {\n                    return [].concat(_toConsumableArray(collector), [current]);\n                  }\n                } else {\n                  return [].concat(_toConsumableArray(collector), [current]);\n                }\n              }, []);\n            }, []);\n          });\n          pastEvents = pastEvents ? pastEvents.sort(sortByStart) : [];\n          futureEvents = futureEvents ? futureEvents.sort(sortByStart) : [];\n          return _context.abrupt(\"return\", {\n            futureEvents: futureEvents,\n            pastEvents: pastEvents,\n            globalSponsors: globalSponsors\n          });\n\n        case 16:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n};\n\nexport default Home;","map":{"version":3,"sources":["/Users/jmartin/Development/GraphCMS/Microsites/graphcms-events/src/pages/index.js"],"names":["React","Link","Sponsors","require","GraphQLClient","Wrapper","props","Home","futureEvents","pastEvents","globalSponsors","next","backgroundImage","image","url","clipPath","slug","title","venue","name","__html","description","html","slice","map","event","index","getInitialProps","ctx","query","graphQLClient","process","env","GRAPHCMS_ENDPOINT","credentials","mode","headers","Authorization","GATSBY_GRAPHCMS_TOKEN","request","events","now","Date","sortByStart","a","b","start","sortBySpeaker","forEach","payload","tracks","sponsors","push","speakers","reduce","collector","currentTrack","timeSlots","timeSlot","talk","speaker","filter","Boolean","sort","current","length"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Link } from 'next/link';\nimport Sponsors from '../components/Sponsors';\n\nconst { GraphQLClient } = require('graphql-request');\n\nconst Wrapper = props => (\n  <section className=\"container mx-auto px-6 py-12 lg:py-20\" {...props} />\n);\n\nconst Home = ({ futureEvents, pastEvents, globalSponsors }) => {\n  const next = futureEvents[0];\n  return (\n    <React.Fragment>\n      <section\n        className=\"bg-cover bg-purple-800 pb-32 pt-8\"\n        style={{\n          backgroundImage: `linear-gradient(rgba(107, 70, 193,0.85), rgba(107, 70, 193,0.5)), url(${next.image.url})`,\n          clipPath:\n            'polygon(0% 0%, 100% 0%, 100% 85%, 30% 85%, 30% 100%, 0% 85%)',\n        }}\n      >\n        <Wrapper>\n          <Link href={next.slug}>\n            <a>\n              <article>\n                <div className=\"z-10 relative px-4 self-center w-2/3\">\n                  <p className=\"text-white inline-block font-bold text-sm\">\n                    Up Next\n                  </p>\n                  <h1 className=\"text-6xl font-bold leading-tight text-white\">\n                    {next.title}\n                  </h1>\n                  <p className=\"text-xl font-bold pb-3 text-purple-200\">\n                    {next.venue && next.venue.name}\n                  </p>\n                </div>\n                <section className=\"flex flex-wrap\">\n                  <div\n                    className=\"w-full md:w-1/2 text-white bg-gray-900 p-6\"\n                    dangerouslySetInnerHTML={{ __html: next.description.html }}\n                  />\n                </section>\n              </article>\n            </a>\n          </Link>\n        </Wrapper>\n      </section>\n      <Wrapper>\n        <h2 className=\"text-purple-800 text-4xl md:text-6xl font-bold mb-6\">\n          Upcoming Events\n        </h2>\n        <section className=\"flex flex-wrap overflow-hidden -mx-2\">\n          {futureEvents &&\n            futureEvents.slice(1).map((event, index) => {\n              return (\n                <Link className=\"w-full md:w-1/2 px-2 mb-10\" href={event.slug}>\n                  <a>\n                    <article key={index}>\n                      <img src={event.image ? event.image.url : ''} />\n                      <h1 className=\"font-bold text-gray-800 text-xl mb-2\">\n                        {event.title}\n                      </h1>\n                      <p>{event.venue ? event.venue.name : 'TBD'}</p>\n                    </article>\n                  </a>\n                </Link>\n              );\n            })}\n        </section>\n      </Wrapper>\n      <Sponsors sponsors={globalSponsors} />\n    </React.Fragment>\n  );\n};\n\nHome.getInitialProps = async ctx => {\n  const query = `\n  fragment assetInfo on Asset {\n    handle\n    width\n    height\n    url\n  }\n\n  fragment venueInfo on Venue {\n    id\n    name\n    location {\n      lat: latitude\n      lng: longitude\n    }\n    street\n    city\n    postcode\n    country\n  }\n\n  fragment speakerInfo on Speaker {\n    name\n    headline\n    photo {\n      ...assetInfo\n    }\n  }\n\n  fragment talkInfo on Talk {\n    id\n    title\n    speaker {\n      ...speakerInfo\n    }\n  }\n\n  fragment trackInfo on Track {\n    id\n    title\n    mc {\n      ...speakerInfo\n    }\n    timeSlots(orderBy: start_ASC) {\n      id\n      start\n      end\n      talk {\n        ...talkInfo\n      }\n      sessionBreak: break {\n        title\n      }\n    }\n  }\n\n  fragment EventInfo on Event {\n    id\n    title\n    slug\n    start\n    image {\n      ...assetInfo\n    }\n    description {\n      html\n    }\n    tracks {\n      ...trackInfo\n    }\n    sponsors {\n      name\n      url\n      logo {\n        ...assetInfo\n      }\n    }\n    venue {\n      ...venueInfo\n    }\n  }\n\n  query {\n      globalSponsors: sponsors(where: {\n        type: GLOBAL\n      }) {\n        name\n        url\n        logo {\n          ...assetInfo\n        }\n      }\n      events {\n        ...EventInfo\n      }\n  }\n`;\n\n  const graphQLClient = new GraphQLClient(process.env.GRAPHCMS_ENDPOINT, {\n    credentials: 'include',\n    mode: 'cors',\n    headers: {\n      Authorization: `Bearer ${process.env.GATSBY_GRAPHCMS_TOKEN}`,\n    },\n  });\n\n  const request = await graphQLClient.request(query);\n\n  const { events, globalSponsors } = request;\n\n  if (events) {\n    let pastEvents = [];\n    let futureEvents = [];\n\n    const now = new Date();\n\n    const sortByStart = (a, b) => {\n      if (a.start < b.start) return -1;\n      if (a.start > b.start) return 1;\n      if (a.start === b.start) return 0;\n    };\n\n    const sortBySpeaker = (a, b) => {\n      if (a.name < b.name) return -1;\n      if (a.name > b.name) return 1;\n      if (a.name === b.name) return 0;\n    };\n\n    events.forEach(payload => {\n      const { tracks, sponsors, venue, ...event } = payload;\n\n      if (new Date(event.start) < now) pastEvents.push(payload);\n      if (new Date(event.start) > now) futureEvents.push(payload);\n\n      const speakers = tracks.reduce((collector, currentTrack) => {\n        return [\n          ...collector,\n          ...currentTrack.timeSlots.map(timeSlot =>\n            timeSlot.talk ? timeSlot.talk.speaker : null\n          ),\n        ]\n          .filter(Boolean)\n          .sort(sortBySpeaker)\n          .reduce((collector, current) => {\n            if (collector.length) {\n              if (current.name === collector[collector.length - 1].name) {\n                return collector;\n              } else {\n                return [...collector, current];\n              }\n            } else {\n              return [...collector, current];\n            }\n          }, []);\n      }, []);\n    });\n\n    pastEvents = pastEvents ? pastEvents.sort(sortByStart) : [];\n    futureEvents = futureEvents ? futureEvents.sort(sortByStart) : [];\n\n    return { futureEvents, pastEvents, globalSponsors };\n  }\n};\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}